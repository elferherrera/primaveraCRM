{% extends "base.html" %}
{% import "_macros.html" as macros %}

{% block content %}
    <div class="d-flex align-items-center p-3 my-3 text-white-50 bg-header rounded box-shadow">
      <h1>{{ current_user.name }}</h1>
    </div>

    <p class="text-center">
      <strong>Actividades resgistradas</strong>
    </p>

    <div class="alert alert-primary">
        <nav class="navbar navbar-expand-lg navbar-light">
          <a class="navbar-brand" href="#"></a>
          <button class="navbar-toggler"
                    type="button"
                    data-toggle="collapse"
                    data-target="#navbarSupportedContent"
                    aria-controls="navbarSupportedContent"
                    aria-expanded="false"
                    aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>

          <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav mr-auto">
              <li class="nav-item dropdown active">
                <a class="nav-link dropdown-toggle"
                    href="#"
                    id="navbarDropdown"
                    role="button"
                    data-toggle="dropdown"
                    aria-haspopup="true"
                    aria-expanded="false">
                  Filtrar
                </a>
                <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                  <a class="dropdown-item"
                      href="{{ url_for('index', filter='all') }}">
                      Todas
                  </a>
                  <div class="dropdown-divider"></div>
                  <a class="dropdown-item"
                      href="{{ url_for('index', filter='today') }}">
                      Hoy
                  </a>
                  <a class="dropdown-item"
                      href="{{ url_for('index', filter='old') }}">
                      Vencidas
                  </a>

                </div>
              </li>
            </ul>

          </div>
        </nav>
      </div>

    <table class="table">
      <tbody>
        {% for activity in pagination.items %}
          <tr>
            <td>

              <div class="title-area">
                <div class="btn-group dropup">
                  <button type="button"
                          class="btn btn-secondary dropdown-toggle"
                          data-toggle="dropdown"
                          aria-expanded="false">
                    {{ activity.title}}
                    <small>
                      ({{ activity.account.name }})
                      ({{ activity.start_date.strftime("%d/%m/%Y") }})
                      ({{ activity.type.name }})
                    </small>
                  </button>

                  <ul class="dropdown-menu ul-drp" role="menu">
                    <li class="li-drp">
                      <a class="dropdown-item"
                          data-toggle="collapse"
                          href="#c-{{ activity.id }}"
                          role="button"
                          aria-expanded="false"
                          aria-controls="collapseExample">
                          Detalles
                      </a>
                    </li>
                    <li class="li-drp">
                      <a class="dropdown-item"
                          href="{{ url_for("account_activity", id=activity.id) }} ">
                          Ir a actividad
                      </a>
                    </li>
                  </ul>
                </div>
                </br>

                <div class="card">
                  <div class="card-body">
                    {{ activity.body }}
                  </div>
                </div>
              </div>

              <div class="table-area">
                <div class="collapse" id="c-{{ activity.id }}">
                    <strong>
                      Responsable: {{ activity.responsable.name }}
                      <small>(
                      {% if activity.completed %}
                        Completada
                      {% else %}
                          Sin completar
                      {% endif %}
                      )
                      (Creador: {{ activity.creator.name }})
                      </small>
                    </strong>

                    <table class="table table-striped">
                      <tr>
                          <td>Creada</td>
                          <td>
                              {{ activity.timestamp.strftime("%d/%m/%Y") }}
                          </td>
                      </tr>
                      <tr>
                          <td>Inicio</td>
                          <td>
                              {{ activity.start_date.strftime("%d/%m/%Y") }}
                          </td>
                      </tr>
                      <tr>
                          <td>Final</td>
                          <td>
                              {{ activity.end_date.strftime("%d/%m/%Y") }}
                          </td>
                      </tr>
                    </table>
                </div>
              </div>

            </td>
          </tr>

        {% endfor %}
      </tbody>
    </table>

  {% if pagination %}
    {{ macros.pagination_widget_dict(pagination, 'index') }}
  {% endif %}

{% endblock %}
