{% extends "base.html" %}
{% import "_macros.html" as macros %}

{% block content %}
    <div class="d-flex align-items-center p-3 my-3 text-white-50 bg-header rounded box-shadow">
      <h1>{{ current_user.name }}</h1>
    </div>

    <p class="text-center">
      <strong>Actividades resgistradas</strong>
    </p>

    <table class="table">
      <tbody>
        {% for activity in pagination.items %}
          <tr>
            <td>

              <div class="title-area">
                <div class="btn-group dropup">
                  <button type="button"
                          class="btn btn-secondary dropdown-toggle"
                          data-toggle="dropdown"
                          aria-expanded="false">
                    {{ activity.title}}
                    <small>
                      ({{ activity.account.name }})
                      ({{ activity.type.name }})
                    </small>
                  </button>

                  <ul class="dropdown-menu ul-drp" role="menu">
                    <li class="li-drp">
                      <a class="dropdown-item"
                          data-toggle="collapse"
                          href="#c-{{ activity.id }}"
                          role="button"
                          aria-expanded="false"
                          aria-controls="collapseExample">
                          Detalles
                      </a>
                    </li>
                    <li class="li-drp">
                      <a class="dropdown-item"
                          href="{{ url_for("account_activity", id=activity.id) }} ">
                          Ir a actividad
                      </a>
                    </li>
                  </ul>
                </div>
                </br>

                <div class="card">
                  <div class="card-body">
                    {{ activity.body }}
                  </div>
                </div>
              </div>

              <div class="table-area">
                <div class="collapse" id="c-{{ activity.id }}">
                    <strong>
                      Responsable: {{ activity.responsable.name }}
                      <small>(
                      {% if activity.completed %}
                        Completada
                      {% else %}
                          Sin completar
                      {% endif %}
                      )
                      (Creador: {{ activity.creator.name }})
                      </small>
                    </strong>

                    <table class="table table-striped">
                      <tr>
                          <td>Creada</td>
                          <td>
                              {{ activity.timestamp.strftime("%d/%m/%Y") }}
                          </td>
                      </tr>
                      <tr>
                          <td>Inicio</td>
                          <td>
                              {{ activity.start_date.strftime("%d/%m/%Y") }}
                          </td>
                      </tr>
                      <tr>
                          <td>Final</td>
                          <td>
                              {{ activity.end_date.strftime("%d/%m/%Y") }}
                          </td>
                      </tr>
                    </table>
                </div>
              </div>

            </td>
          </tr>

        {% endfor %}
      </tbody>
    </table>

  {% if pagination %}
    {{ macros.pagination_widget_dict(pagination, 'index') }}
  {% endif %}

{% endblock %}
